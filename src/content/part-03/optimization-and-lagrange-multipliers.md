# Optimization and Lagrange Multipliers

III . $64$ .

Optimization and Lagrange Multipliers

Amazingly, unique factorization may be restored by embedding O K into a larger set, which consists of objects called ideals [III.81](/part-03/rings-ideals-and-modules). There is a natural equivalence relation [I.2](/part-01/language-and-grammar) that one can place on these ideals, and the number of equivalence classes, called the class number and written h (K), is one of the most important invariants in number theory: in a certain sense, it measures “the extent to which unique factorization fails” in the number field K. (See algebraic numbers [IV.1](/part-04/number-theory) for more details .) The fact that it is finite is one of the two basic finiteness theorems in algebraic number theory. When h (K) $= 1$ , the integers O K themselves enjoy unique factorization, without the need for extra ideals. This does not happen particularly often; among the √ fields Q ( - d) with d positive and squarefree, only nine have this property, namely $d = 1$ , $2$ , $3$ , $7$ , $11$ , $19$ , $43$ , $67$ , and $163$ . The problem of determining these numbers was posed by gauss [VI.26](/part-06/carl-friedrich-gauss-17771855) and finally solved by Heegner in 1952 . √ The fact that $h(Q( - 163)) = 1$ is closely related to some remarkable facts. For example, the polynomial $x^{2} + x + 41$ takes prime values when $x = 0$ , $1$ , . . . √ , $39$ (observe that $4 \times 41 = 163 + 1)$ , and the number $e\pi^{163}$ is within $10 - 12$ of an integer. It is a well-known open problem to decide whether or √ not there are infinitely many fields Q (d), d $> 0$ , with class number $1$ . Gauss and many subsequent authors have conjectured that there are. The second basic finiteness result in algebraic number theory is Dirichlet’s unit theorem. A unit is simply some x $\in$ O K such that there exists y $\in$ O K with $xy = 1$ . The numbers $1$ and $- 1$ are always units, but √ there can certainly be others: for example, $17 - 12 2$ √is a unit in $Q( 2)$ (since its reciprocal is $17 + 12 2)$ . The units form an Abelian group U K under multiplication. Dirichlet’s theorem states that this group has finite rank, which means that it is generated by finitely many of its elements. √ If $d > 0$ is squarefree and if $K = Q( d)$ , then $U^{K}$ has rank $1$ . When $d$ ≡ 1 ($mod$4), the fact that it has rank at least $1$ is equivalent to the statement that the Pell equation $x^{2} - dy^{2} = 1$ always has a nontrivial solution. This is because the Pell equation factors as √$(x - y d)(x + y d) = 1$ . The unit $17 - 12 2$ in $Q( 2)$ corresponds to the solution $x = 17$ , $y = 12$ of the equation $x^{2} - 2y^{2} = 1$ . For more about some of the topics discussed in this article, see fermat’s last theorem [V.10](/part-05/fermats-last-theorem). $255$ III . $64$ Optimization and Lagrange Multipliers Keith Ball $1$ Optimization Soon after being introduced to calculus, most students learn of its application to optimization: that is, to the problem of finding the largest or smallest value of a given differentiable function, which is usually referred to as the objective function. A very helpful observation is that if f is an objective function that is maximized or minimized at x, then the tangent to the graph at the point (x , f (x)) will be horizontal, since otherwise we can find some value x close to x for which f (x) is higher. This means that we can narrow down the search for the maximum and minimum values of f by looking just at the values of f (x) for which f (x) $= 0$ . Now suppose that we have an objective function of more than one variable, such as, for example, the function  F(x , $y) = 2x + 10y - x^{2} + 2xy - 3y^{2}$ . The “graph” of F is obtained by plotting the values F (x , y) of F as heights above the corresponding points (x , y) of the plane, so now it is a surface instead of a curve. A smooth surface possesses not a tangent line at each point, but a tangent plane. If F has a maximum value, it will occur at a point where the tangent plane is horizontal. The tangent plane at each point (x , y) is the graph of the linear function that best approximates F near (x , y). For small values of $h$ and $k$, F (x + h, y + k) will be approximately equal to F (x , y) plus a function of the form (h , $k)\to ah + bk,$ that is, F (x , y) plus a linear function of $h$ and $k$. As explained in some fundamental mathematical definitions [I.3](/part-01/fundamental-definitions), the derivative of F at (x , y) is this linear map. The map can be represented by the pair of numbers (a , b), which can in turn be thought of as a vector in $R^{2}$ . This derivative vector is usually called the gradient of the function F at the point (x , y) and is written $\nablaF$ (x , y). In vector notation (writing x for (x , y) and h for (h , k)), the approximation to F near (x , y) is $F(x + h)\approxF(x) + h$ · $\nablaF$ . (1)

256                                                                                                   III. Mathematical Concepts

Thus, ∇F points in the direction in which F increases              6
most rapidly if you start at x, and the magnitude of ∇F
is the slope of the “graph” of F in this direction.                5
   The components a and b of the gradient can be calcu-
                                                                   4
lated using partial differentiation. The number a tells
us how quickly F (x, y) changes as we vary x while                 3                                   19
keeping y fixed: so to find a, we differentiate F (x, y) =
                                                                                                       18
2 x +10 y −x 2 +2 xy −3 y 2 with respect to x, treating y              2
as a constant. In this case we get the partial derivative                                              14
                  ∂F (x, y)
                                                                   1                                   8
             a=             = 2 − 2 x + 2 y.
                     ∂x                                                                                0
                                                                   0
Similarly,                                                             0                 2            4             6       8
                  ∂F (x, y)                                                           Figure 1 A contour plot.
              b=            = 10 + 2 x − 6 y.
                      ∂y
  Now, if we want to locate points where the tangent
plane is horizontal, then we want to find the points at                 3
which the gradient is zero: that is, the points at which
the vector (a, b) is the zero vector. So we solve the pair             2
of simultaneous equations                                                       4 y − x = 7
                     2 − 2 x + 2 y = 0,                                  1
                   10 + 2 x − 6 y = 0
to get x = 4, y = 3. Thus, the only candidate for the                  0
maximum is the point (4, 3), where F takes the value 19.
It can be checked that 19 is indeed the maximum value              −1
of F .                                                                                            4 y − x = −7
                                                                   −2
             2 The Gradient and Contours
One of the most common ways of representing surfaces               −3
(landscapes on maps, for example) is by means of con-                      −3       −2       −1        0        1       2   3
tour lines, or curves of constant height. In the xy-plane,
                                                                                Figure 2 Constrained optimization.
we plot several curves of the form F (x, y) = V , for var-
ious “representative” values of V . For the function we
considered earlier,                                                             3    Constrained Optimization
                                  2
        F (x, y) = 2 x + 10 y − x + 2 xy − 3 y ,     2                                  and Lagrange Multipliers

the values 0, 8, 14, 18, 19 yield the contour plot shown      It often happens that we are interested in the maxi-
in figure 1. The 14 contour, for example, contains all         mum or minimum value of an objective function that
the points at which the surface has height 14. The fig-        depends upon several variables whose values are con-
ure indicates that this particular surface is an elliptical   strained to satisfy certain equations or inequalities.
hump whose peak occurs at (4, 3) and has height 19.           Consider, for example, the following problem.
  There is a simple geometrical relationship between
                                                              Find the maximum value of
the contour lines and the gradient vector. The vector
equation (1) shows that the direction h in which F is                                    F (x, y) = 4 y − x
instantaneously constant is the direction which makes         over all pairs (x, y) satisfying the constraint
the scalar product h · ∇F equal to 0: the direction per-
                                                                       G(x, y) = x 2 − xy + y 2 − x + y − 4 = 0.                (2)
pendicular to ∇F . At each point, the gradient vector is
perpendicular to the contour through that point. This            Figure 2 shows the curve in the xy-plane defined by
fact underlies the method of Lagrange multipliers that        G(x, y) = 0 (an ellipse), and also a number of contour
we shall discuss in the next section.                         lines of the function 4 y − x. Our aim is to find the

